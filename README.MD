# Библиотека s21_containers

## Обзор

Библиотека `s21_containers` — это реализация контейнерных классов на C++, в частности `List` и `Queue`, разработанных для имитации функциональности контейнеров стандартной библиотеки шаблонов C++ (STL). Библиотека предоставляет надежную и эффективную реализацию двусвязного списка (`s21::List`) и очереди (`s21::Queue`), построенной на основе списка, с поддержкой современных возможностей C++20, итераторов и вариадических шаблонных методов для гибкой вставки элементов.

Проект структурирован для обеспечения кроссплатформенной совместимости (Linux и macOS) с использованием комплексной системы сборки через `Makefile` для компиляции, тестирования, анализа покрытия кода, проверки памяти и соблюдения стиля кодирования.

## Особенности

- **s21::List**: Шаблонная реализация двусвязного списка, поддерживающая:
  - Стандартные операции: `Push_back`, `Push_front`, `Pop_back`, `Pop_front`, `Insert`, `Erase` и т.д.
  - Поддержка итераторов: Двунаправленные итераторы (`ListIterator` и `ListConstIterator`) для обхода и модификации.
  - Расширенные операции: `Merge`, `Splice`, `Reverse`, `Unique`, `Sort`.
  - Вариадические шаблонные методы: `Insert_many`, `Insert_many_back`, `Insert_many_front` для гибкой вставки элементов.
- **s21::Queue**: Шаблонная реализация очереди, построенная на основе `s21::List`, поддерживающая:
  - Стандартные операции очереди: `Push`, `Pop`, `Front`, `Back`, `Empty`, `Size`.
  - Дополнительные функции: `Swap` и вариадический `Insert_many_back`.
- **Кроссплатформенность**: Совместимость с Linux (g++) и macOS (clang++).
- **Тестирование**: Полный набор модульных тестов с использованием Google Test.
- **Анализ покрытия кода**: Поддержка отчетов о покрытии с помощью `lcov` (Linux) или `llvm-cov` (macOS).
- **Безопасность памяти**: Поддержка AddressSanitizer (ASan) и Valgrind (Linux) для обнаружения утечек памяти.
- **Стиль кодирования**: Соблюдение Google C++ Style Guide с использованием `clang-format`.

## Структура проекта

```
s21_containers/
├── s21_containers.h       # Основной заголовочный файл, включающий List и Queue
├── Makefile               # Система сборки для компиляции, тестирования и анализа покрытия
├── list/
│   ├── s21_list.h         # Заголовочный файл класса List с объявлениями
│   └── s21_list.tpp       # Реализация шаблонов класса List
├── queue/
│   └── s21_queue.h        # Заголовочный файл класса Queue с объявлениями
└── tests/
    └── *.cpp              # Модульные тесты для List и Queue
```

## Требования

- **Компилятор C++**:
  - Linux: `g++` (с поддержкой C++20)
  - macOS: `clang++` с `libc++` (с поддержкой C++20)
- **Google Test**: Требуется для запуска модульных тестов.
  - Linux: Установите через менеджер пакетов (например, `libgtest-dev`) или убедитесь, что `pkg-config` может найти библиотеку.
  - macOS: Установите через Homebrew (`brew install googletest`).
- **Инструменты для покрытия кода**:
  - Linux: `lcov` и `genhtml` для создания отчетов о покрытии.
  - macOS: `llvm-profdata` и `llvm-cov` (включены в Xcode).
- **Valgrind** (только для Linux): Для обнаружения утечек памяти.
- **clang-format**: Для соблюдения стиля кодирования (Google style).

## Сборка и запуск

`Makefile` предоставляет несколько целей для сборки, тестирования и анализа проекта. Ниже приведены основные команды:

- **Сборка и запуск тестов**:

  ```bash
  make test
  ```

  Компилирует и запускает модульные тесты с использованием Google Test.

- **Создание отчета о покрытии кода**:

  ```bash
  make gcov_report
  ```

  Запускает тесты и создает HTML-отчет о покрытии в каталоге `gcov_report/`. Открывает отчет в браузере.

- **Запуск AddressSanitizer**:

  ```bash
  make test_asan
  ```

  Компилирует и запускает тесты с AddressSanitizer для обнаружения проблем с памятью.

- **Запуск Valgrind (только Linux)**:

  ```bash
  make test_valgrind
  ```

  Запускает тесты с инструментом memcheck Valgrind для обнаружения утечек памяти. Логи сохраняются в `logs/valgrind_log.txt`.

- **Проверка стиля кодирования**:

  ```bash
  make test_style
  ```

  Проверяет, что все исходные файлы соответствуют Google C++ Style Guide.

- **Применение стиля кодирования**:

  ```bash
  make style
  ```

  Форматирует все исходные файлы с помощью `clang-format` в соответствии с Google style.

- **Очистка артефактов сборки**:

  ```bash
  make clean
  ```

  Удаляет объектные файлы, исполняемые файлы и данные покрытия.

- **Очистка файлов покрытия**:

  ```bash
  make clean_coverage
  ```

  Удаляет только файлы, связанные с покрытием кода.

## Пример использования

Ниже приведен пример использования классов `s21::List` и `s21::Queue`:

```cpp
#include "s21_containers.h"
#include <iostream>

int main() {
    // Использование s21::List
    s21::List<int> list = {1, 2, 3, 4};
    list.Push_front(0);
    list.Insert_many_back(5, 6, 7);
    for (auto it = list.Begin(); it != list.End(); ++it) {
        std::cout << *it << " "; // Вывод: 0 1 2 3 4 5 6 7
    }
    std::cout << std::endl;

    // Использование s21::Queue
    s21::Queue<int> queue = {10, 20, 30};
    queue.Push(40);
    std::cout << "Front: " << queue.Front() << std::endl; // Вывод: 10
    queue.Pop();
    std::cout << "Front after pop: " << queue.Front() << std::endl; // Вывод: 20

    return 0;
}
```

## Детали реализации

- **s21::List**:
  - Реализован как двусвязный список с использованием структур `ListNode`, содержащих `value`, `next` и `prev` указатели.
  - Поддерживает двунаправленные итераторы для гибкого обхода.
  - Использует вариадические шаблоны для операций `Insert_many`, обеспечивая эффективную вставку нескольких элементов.
  - Сортировка реализована с использованием алгоритма слияния (merge sort) для стабильности и производительности.
- **s21::Queue**:
  - Построена на основе `s21::List` для использования его функциональности.
  - Предоставляет интерфейс FIFO (First-In-First-Out) с минимальными накладными расходами.
- **Управление памятью**:
  - Вся память управляется вручную для предотвращения утечек, что проверяется с помощью ASan и Valgrind.
  - Итераторы выбрасывают исключения `std::out_of_range` при некорректном разыменовании или операциях с пустыми контейнерами.

## Тестирование

Каталог `tests/` содержит модульные тесты для `List` и `Queue`, охватывающие:

- Основные операции (push, pop, insert, erase).
- Функциональность итераторов.
- Расширенные операции (merge, splice, sort, unique).
- Пограничные случаи (пустые контейнеры, операции с одним элементом).

Запустите `make test` для выполнения всех тестов. Используйте `make gcov_report` для проверки высокого уровня покрытия тестами.

## Участие в разработке

Чтобы внести вклад:

1. Сделайте форк репозитория.
2. Создайте ветку для новой функциональности (`git checkout -b feature-name`).
3. Убедитесь, что код соответствует Google C++ Style Guide (`make style`).
4. Добавьте или обновите модульные тесты в каталоге `tests/`.
5. Проверьте безопасность памяти (`make test_asan` или `make test_valgrind`).
6. Отправьте pull request с подробным описанием изменений.
